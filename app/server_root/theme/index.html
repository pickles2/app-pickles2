<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>テーマ編集 | Pickles 2 Desktop Tool - HELP</title>

		<meta name="viewport" content="width=device-width" />
		<meta name="keywords" content="" />
		<meta name="description" content="" />

 
<!-- jQuery -->
<script src="../common/scripts/jquery-1.10.1.min.js" type="text/javascript"></script>

<!-- Bootstrap -->
<link rel="stylesheet" href="../common/styles/bootstrap/css/bootstrap.min.css">
<script src="../common/styles/bootstrap/js/bootstrap.min.js"></script>

<!-- FESS -->
<link rel="stylesheet" href="../common/styles/contents.css" type="text/css" />

		<!-- Bootstrap Theme -->
		<link rel="stylesheet" href="../caches/p/theme/styles/bootstrap-theme.min.css">
		<link rel="stylesheet" href="../caches/p/theme/styles/theme.css">
<style>

</style>
	</head>
	<body>
		<header class="theme_header" id="page_top">
			<div class="container">
				<p class="theme_si"><a href="../index.html">Pickles 2 Desktop Tool - HELP</a></p>
				<div class="theme_shouldernavi">
<ul></ul>				</div>
				<div class="theme_globalnavi">
<ul><li><a href="../intro/index.html">概要</a></li><li><a href="../sitemap/index.html">サイトマップ編集</a></li><li><a href="./index.html" class="current">テーマ編集</a></li><li><a href="../contents/index.html">コンテンツ編集</a></li><li><a href="../publish/index.html">パブリッシュ</a></li><li><a href="../other/index.html">その他の機能</a></li></ul>
				</div>
			</div>
		</header>
		<div class="theme_mainblock">
			<div class="container">
				<div class="row">
					<div class="col-sm-9">
						<div class="theme_breadcrumb"><ul><li><a href="../index.html">ヘルプトップ</a></li><li><span>テーマ編集</span></li></ul></div>
						<h1>テーマ編集</h1>
						<div class="contents">
<p>テーマは、ページ要素のうち、ヘッダー、フッター、ナビゲーションなど、サイト全体を通して共通の規則にしたがって生成されるべき部分を一元管理する概念。コンテンツ領域以外のHTMLソースを自動的に生成します。</p>

<!-- == autoindex == -->
<div style="margin:2em 5%; border:1px solid #bbb; padding:1em; background:rgba(124, 124, 124, 0.05); border-radius:5px;">
<div style="margin:0; padding:0; text-align:center; font-weight:bold;">INDEX</div><ul style="margin:0; padding:0 0 0 2em;"><li style="list-style-type:disc; display:list-item;"><a href="#hash_テーマの格納ディレクトリ">テーマの格納ディレクトリ</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_レイアウト">レイアウト</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_テンプレートの記述">テンプレートの記述</a><ul style="margin:0; padding:0 0 0 2em;"><li style="list-style-type:disc; display:list-item;"><a href="#hash_コンテンツを出力する">コンテンツを出力する</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_コンテンツが定義したCSSやJavaScriptを出力する">コンテンツが定義したCSSやJavaScriptを出力する</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_コンテンツの環境構築">コンテンツの環境構築</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_ページの情報を出力する">ページの情報を出力する</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_ページ名を出力する">ページ名を出力する</a><ul style="margin:0; padding:0 0 0 2em;"><li style="list-style-type:disc; display:list-item;"><a href="#hash_メタタグ_descriptionを出力する">メタタグ descriptionを出力する</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_メタタグkeywordsを出力する">メタタグkeywordsを出力する</a></li>
<li style="list-style-type:disc; display:list-item;"><a href="#hash_ページ名(h1用)を出力する">ページ名(h1用)を出力する</a></li></ul></li></ul></li><li style="list-style-type:disc; display:list-item;"><a href="#hash_GUI編集のためのコンテンツエリア指定">GUI編集のためのコンテンツエリア指定</a></li></ul>
</div>
<!-- / == autoindex == -->


<span id="hash_テーマの格納ディレクトリ"></span><h2>テーマの格納ディレクトリ</h2>

<p>テーマは、次のディレクトリに格納されます。</p>

<pre><code>./px-files/themes/{$テーマ名}/
</code></pre>

<!--

### 複数のテーマの管理と切り替え

Pickles Framework では、1サイトに複数のテーマを定義することができます。テーマにはそれぞれ名前を付けます。デフォルトのテーマのテーマ名は <code>&quot;default&quot;</code> です。

テーマは、URLパラメータに <code>?THEME={$テーマ名}</code> と付加して切り替えることができます。

<div class="unit">
    <div class="code"><pre><code>例： http://xxxxxxxxx/?THEME={$テーマ名}
</code></pre></div>
</div>

-->

<span id="hash_レイアウト"></span><h2>レイアウト</h2>

<p>テーマは、複数のテンプレートを定義することができます。これはレイアウトと呼ばれ、サイトマップの layout 列にレイアウト名を指定することによって切り替えることができます。デフォルトのレイアウトは <code>default</code> です。</p>

<pre><code>./px-files/themes/{$テーマ名}/{$レイアウト名}.html
</code></pre>

<p>初期状態では、default(標準レイアウト)、top(トップページ用レイアウト)、plain(<code>&lt;body&gt;</code>の直下にコンテンツエリアを配したレイアウト)、popup(ポップアップウィンドウ用レイアウト)、naked(コンテンツエリアのみが出力されるレイアウト)が定義されていますが、任意に増やすことができます。</p>

<span id="hash_テンプレートの記述"></span><h2>テンプレートの記述</h2>

<p>テーマは、コンテンツ領域のソースを変数として受け取り、HTML全体を補完して完成させます。テーマのテンプレートは、DOCTYPE宣言、htmlタグ、headセクション、bodyセクションを出力し、ヘッダー、フッターナビゲーション構造などを生成するのもテーマの役割です。</p>

<p>まず、デフォルトレイアウト <code>default.html</code> に、最低限の基本的なHTMLのセットを用意します。</p>

<div class="unit">
    <div class="code"><pre><code>&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;sample&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div>
</div>

<p>ここに、順を追って必要な動的要素を追加していきます。</p>

<span id="hash_コンテンツを出力する"></span><h3>コンテンツを出力する</h3>

<p>コンテンツは、コンテンツ領域にあたる部分に出力します。関数 <code>$px-&gt;bowl()-&gt;pull()</code> で出力でします。<br />
コンテンツ領域は、必ず <code>class=&quot;contents&quot;</code> の要素で囲われるようにしなければなりません。<br /></p>

<div class="unit">
    <div class="code"><pre><code>&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;sample&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div <strong>class=&quot;contents&quot;</strong>&gt;
<strong>&lt;?php
    //↓コンテンツから受け取った
    //  コンテンツエリアのソースを出力しています。
    print $px-&gt;bowl()-&gt;pull();
?&gt;</strong>
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div>
</div>

<span id="hash_コンテンツが定義したCSSやJavaScriptを出力する"></span><h3>コンテンツが定義したCSSやJavaScriptを出力する</h3>

<p>コンテンツは、そのコンテンツ独自のJavaScript機能やCSSを定義しているかも知れません。CSSやJavaScriptの定義は、headセクション内に出力したいところですが、コンテンツのコードにはheadセクションを含まないので、コンテンツの制作者は関数 <code>$px-&gt;bowl()-&gt;send('HTMLコード', head')</code> を使って、テーマにHTMLを託します。</p>

<p>こうして受け取ったコードは、次の例のように、関数 <code>$px-&gt;bowl()-&gt;pull('head')</code> で出力します。</p>

<div class="unit">
    <div class="code"><pre><code>&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;sample&lt;/title&gt;
<strong>&lt;?php
    //↓コンテンツから受け取った
    //  headセクション内用のソースを出力しています。
    print $px-&gt;bowl()-&gt;pull('head');
?&gt;</strong>
&lt;/head&gt;
&lt;body&gt;
&lt;div class=&quot;contents&quot;&gt;
&lt;?php
    //↓コンテンツから受け取った
    //  コンテンツエリアのソースを出力しています。
    print $px-&gt;bowl()-&gt;pull();
?&gt;
&lt;/div&gt;
<strong>&lt;?php
    //↓コンテンツから受け取った
    //  bodyセクションの最後に出力するソースを出力しています。
    print $px-&gt;bowl()-&gt;pull('foot');
?&gt;</strong>
&lt;/body&gt;
&lt;/html&gt;</code></pre></div>
</div>

<span id="hash_コンテンツの環境構築"></span><h3>コンテンツの環境構築</h3>

<p>コンテンツのHTMLコードが本来の意図通りにレイアウトされるためには、それに必要なCSSなどの環境をテーマから提供する必要があります。しかし、コンテンツ向けのCSS環境はプロジェクトによって一定とは限りません。</p>

<p>そこで「プロジェクトは、コンテンツ向けに提供する環境設定を <code>/common/contents_manifesto.ignore.php</code> に置く」という約束が設けられました。すべてのテーマがこのファイルをインクルードすれば、テーマを取り替えたときにもコンテンツの表示を保証できるようになります。</p>

<div class="unit">
    <div class="code"><pre><code>&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;sample&lt;/title&gt;
<strong>&lt;?php
    // ↓コンテンツの環境構築を読み込みます。
    print $px->get_contents_manifesto();
?&gt;</strong>
&lt;?php
    //↓コンテンツから受け取った
    //  headセクション内用のソースを出力しています。
    print $px-&gt;bowl()-&gt;pull('head');
?&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class=&quot;contents&quot;&gt;
&lt;?php
    //↓コンテンツから受け取った
    //  コンテンツエリアのソースを出力しています。
    print $px-&gt;bowl()-&gt;pull();
?&gt;
&lt;/div&gt;
&lt;?php
    //↓コンテンツから受け取った
    //  bodyセクションの最後に出力するソースを出力しています。
    print $px-&gt;bowl()-&gt;pull('foot');
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div>
</div>

<span id="hash_ページの情報を出力する"></span><h3>ページの情報を出力する</h3>

<p>カレントページの情報は、サイトマップCSVに定義されており、<code>$px-&gt;site()-&gt;get_current_page_info()</code> から取得することができます。</p>

<p>テーマテンプレートには、複数の箇所でページ情報を参照しますので、先頭で <code>$page_info</code> に連想配列に格納して使いまわせるように準備します。</p>

<div class="unit">
    <div class="code"><pre><code><strong>&lt;?php
    //↓ $page_info にページの情報を格納しています。
    //   var_dump( $page_info ); で、変数の内容を確認できます。
    $page_info = $px-&gt;site()-&gt;get_current_page_info();
?&gt;</strong>&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;sample&lt;/title&gt;
&lt;?php
    // ↓コンテンツの環境構築を読み込みます。
    print $px->get_contents_manifesto();
?&gt;
&lt;?php
    //↓コンテンツから受け取った
    //  headセクション内用のソースを出力しています。
    print $px-&gt;bowl()-&gt;pull('head');
?&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class=&quot;contents&quot;&gt;
&lt;?php
    //↓コンテンツから受け取った
    //  コンテンツエリアのソースを出力しています。
    print $px-&gt;bowl()-&gt;pull();
?&gt;
&lt;/div&gt;
&lt;?php
    //↓コンテンツから受け取った
    //  bodyセクションの最後に出力するソースを出力しています。
    print $px-&gt;bowl()-&gt;pull('foot');
?&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div>
</div>

<p>ここで用意した <code>$page_info</code> から、出力する情報を選んで出力します。幾つか例を示します。</p>

<span id="hash_ページ名を出力する"></span><h3>ページ名を出力する</h3>

<p>ページ名には、HTMLの特殊文字が含まれている可能性があります。<code>htmlspecialchars()</code> を通して、エスケープするようにします。</p>

<div class="unit">
    <div class="code"><pre><code>&lt;title&gt;<strong>&lt;?php print htmlspecialchars($page_info['title_full']); ?&gt;</strong>&lt;/title&gt;
</code></pre></div>
</div>

<span id="hash_メタタグ_descriptionを出力する"></span><h4>メタタグ descriptionを出力する</h4>

<div class="unit">
    <div class="code"><pre><code>&lt;meta name=&quot;description&quot; content=&quot;<strong>&lt;?php print htmlspecialchars($page_info['description']); ?&gt;</strong>&quot; /&gt;
</code></pre></div>
</div>

<span id="hash_メタタグkeywordsを出力する"></span><h4>メタタグkeywordsを出力する</h4>

<div class="unit">
    <div class="code"><pre><code>&lt;meta name=&quot;keywords&quot; content=&quot;<strong>&lt;?php print htmlspecialchars($page_info['keywords']); ?&gt;</strong>&quot; /&gt;
</code></pre></div>
</div>

<span id="hash_ページ名(h1用)を出力する"></span><h4>ページ名(h1用)を出力する</h4>

<p>h1見出しは少し特殊です。文字列に改行が含まれている場合があるからです。</p>

<p>HTML特殊文字に加え、改行コードを改行タグに置き換える必要があります。</p>

<div class="unit">
    <div class="code"><pre><code>&lt;h1&gt;<strong>&lt;?php print preg_replace('/\r\n|\r|\n/s', '&lt;br /&gt;', htmlspecialchars($page_info['title_h1']) ); ?&gt;</strong>&lt;/h1&gt;
</code></pre></div>
</div>

<p>この他にも、サイトマップに定義されたすべての項目にアクセスすることができます。</p>

<span id="hash_GUI編集のためのコンテンツエリア指定"></span><h2>GUI編集のためのコンテンツエリア指定</h2>

<p>Pickles 2 Desktop Tool のGUI編集機能は、HTML上の属性値からコンテンツエリアを識別します。</p>

<p>デフォルトでは、セレクタ <code>.contents</code> でマッチする要素をbowl(コンテンツエリア)として扱い、各bowlの名前は要素の <code>id</code> 属性値から採用します(<code>id</code>属性がない場合は、<code>main</code>が省略されているものとします)。</p>

<p>この挙動は、Pickles2のコンフィグで変更することができます。次の例は、属性 <code>data-px2-contents</code> がある要素をbowlとし、その値を bowl名 と解釈するようにしたものです。</p>

<pre><code>&lt;?php
// config.php

$conf-&gt;plugins-&gt;px2dt-&gt;contents_area_selector = '[data-px2-contents]';//←コンテンツエリアを識別するセレクタ(複数の要素がマッチしてもよい)
$conf-&gt;plugins-&gt;px2dt-&gt;contents_bowl_name_by = 'data-px2-contents';//←コンテンツエリアのbowl名を指定する属性名
</code></pre>
						</div>
						<div class="theme_breadcrumb"><ul><li><a href="../index.html">ヘルプトップ</a></li><li><span>テーマ編集</span></li></ul></div>
					</div>
					<div class="col-sm-3">
						<nav class="theme_common_navi">
							<p><a href="./index.html">テーマ編集</a></p>
						</nav>

<a class="twitter-timeline" href="https://twitter.com/pxfw" data-widget-id="567316803953504256">@pxfwさんのツイート</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

					</div>
				</div><!-- /.row -->
			</div><!-- /.container -->
		</div><!-- /.theme_mainblock -->
		<footer class="theme_footer">
			<div class="container">
				<nav class="theme_megafooter_navi">
<ul>
<li><a href="../intro/index.html">概要</a></li>
<li><a href="../sitemap/index.html">サイトマップ編集</a></li>
<li><a href="./index.html" class="current">テーマ編集</a></li>
<li><a href="../contents/index.html">コンテンツ編集</a><ul>
<li><a href="../guieditor/index.html">GUI編集</a></li>
</ul>
</li>
<li><a href="../publish/index.html">パブリッシュ</a></li>
<li><a href="../other/index.html">その他の機能</a><ul>
<li><a href="../other/clearcache/index.html">キャッシュを削除する</a></li>
</ul>
</li>
</ul>
				</nav>
			</div>
			<div class="container theme_footer_shouldernavi">
<ul><li><a href="../index.html">ヘルプトップ</a></li></ul>			</div>
			<div class="container">
				<p style="text-align:center;">(C)Pickles 2 Project.</p>
			</div>
		</footer>
	</body>
</html>
